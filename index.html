<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>VivÃ­ la Cultura Versat</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
body {
  margin: 0;
  background: linear-gradient(180deg, #2C3E50, #1f2a36);
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  font-family: Arial, sans-serif;
}

#game {
  position: relative;
  width: 960px;
  height: 540px;
  background: linear-gradient(180deg, #f5f7fa, #e4e8ec);
  overflow: hidden;
  border-radius: 16px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.3);
}

#hud {
  position: absolute;
  top: 10px;
  left: 20px;
  font-weight: bold;
}

#player {
  position: absolute;
  width: 50px;
  height: 70px;
  left: 40px;
  bottom: 60px;
  font-size: 64px;
  font-weight: 900;
  color: #00CF74;
  line-height: 70px;
  text-align: center;
  user-select: none;
}

.walk {
  animation: walk 0.4s infinite alternate;
}

@keyframes walk {
  from { transform: translateY(0); }
  to { transform: translateY(-4px); }
}

.platform {
  position: absolute;
  background: #2C3E50;
}

#ground {
  bottom: 0;
  left: 0;
  width: 100%;
  height: 40px;
}

#door {
  position: absolute;
  width: 60px;
  height: 90px;
  right: 40px;
  bottom: 40px;
  background: linear-gradient(180deg, #145BB3, #0e3f80);
  border-radius: 10px;
  animation: glow 1.5s infinite alternate;
}

@keyframes glow {
  from { box-shadow: 0 0 10px rgba(20,91,179,0.4); }
  to { box-shadow: 0 0 25px rgba(20,91,179,0.9); }
}

.npc {
  position: absolute;
  width: 40px;
  height: 60px;
  background: #e74c3c;
  border-radius: 8px;
  bottom: 40px;
}

#question {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.7);
  display: none;
  justify-content: center;
  align-items: center;
}

#card {
  background: white;
  padding: 30px;
  width: 70%;
  border-radius: 16px;
  text-align: center;
}

#card button {
  display: block;
  width: 100%;
  margin: 10px 0;
  padding: 14px;
  background: #00CF74;
  border: none;
  color: white;
  border-radius: 8px;
  cursor: pointer;
  text-align: left;
}

.hit {
  animation: hitFlash 0.3s;
}

@keyframes hitFlash {
  0% { background: rgba(231,76,60,0.6); }
  100% { background: transparent; }
}

.shake {
  animation: shake 0.3s;
}

@keyframes shake {
  0% { transform: translateX(0); }
  25% { transform: translateX(-6px); }
  50% { transform: translateX(6px); }
  75% { transform: translateX(-6px); }
  100% { transform: translateX(0); }
}
</style>
</head>

<body>

<div id="game">
  <div id="hud">
    Fase <span id="phaseNum">1</span> / 6 | Vidas: <span id="lives">3</span>
  </div>

  <div id="player">V</div>
  <div id="door"></div>

  <div class="npc" style="left:300px;"></div>
  <div class="npc" style="left:520px;"></div>

  <div id="ground" class="platform"></div>

  <div id="question">
    <div id="card">
      <h2 id="qText"></h2>
      <div id="options"></div>
      <p id="feedback"></p>
    </div>
  </div>
</div>

<script>
const phases = [
  { q:"Â¿QuÃ© representa la cultura Versat?", a:[
    {t:"Un manual rÃ­gido",c:false},
    {t:"CÃ³mo trabajamos y decidimos",c:true},
    {t:"Solo la marca",c:false}
  ]},
  { q:"Â¿Para quÃ© sirve el Culture Code?", a:[
    {t:"Alinear decisiones",c:true},
    {t:"Controlar personas",c:false},
    {t:"Uso exclusivo del liderazgo",c:false}
  ]},
  { q:"La cultura se viveâ€¦", a:[
    {t:"En el dÃ­a a dÃ­a",c:true},
    {t:"En eventos",c:false},
    {t:"En documentos",c:false}
  ]},
  { q:"Â¿QuiÃ©n es responsable?", a:[
    {t:"RRHH",c:false},
    {t:"Todas las personas",c:true},
    {t:"Solo lÃ­deres",c:false}
  ]},
  { q:"La cultura ayuda aâ€¦", a:[
    {t:"Tomar mejores decisiones",c:true},
    {t:"Evitar cambios",c:false},
    {t:"Reducir comunicaciÃ³n",c:false}
  ]},
  { q:"Vivir la cultura esâ€¦", a:[
    {t:"Actuar con coherencia",c:true},
    {t:"Seguir reglas ciegamente",c:false},
    {t:"Priorizar resultados",c:false}
  ]}
];

const game = document.getElementById("game");
const player = document.getElementById("player");
const door = document.getElementById("door");
const question = document.getElementById("question");
const qText = document.getElementById("qText");
const options = document.getElementById("options");
const feedback = document.getElementById("feedback");
const phaseNumEl = document.getElementById("phaseNum");
const livesEl = document.getElementById("lives");

let phase = 0;
let lives = 3;
let x = 40, y = 60, vy = 0;
let onGround = true;
let questionOpen = false;
let hitCooldown = false;

const keys = { left:false, right:false, up:false };

const npcs = Array.from(document.querySelectorAll(".npc")).map(npc => ({
  el: npc,
  x: parseInt(npc.style.left),
  start: parseInt(npc.style.left) - 80,
  end: parseInt(npc.style.left) + 80,
  speed: 1.2,
  dir: 1
}));

document.addEventListener("keydown", e=>{
  if(e.key==="ArrowLeft") keys.left=true;
  if(e.key==="ArrowRight") keys.right=true;
  if(e.key==="ArrowUp") keys.up=true;
});

document.addEventListener("keyup", e=>{
  if(e.key==="ArrowLeft") keys.left=false;
  if(e.key==="ArrowRight") keys.right=false;
  if(e.key==="ArrowUp") keys.up=false;
  if(!keys.left&&!keys.right) player.classList.remove("walk");
});

function update(){
  if(keys.right){ x+=5; player.classList.add("walk"); }
  if(keys.left){ x-=5; player.classList.add("walk"); }

  if(keys.up && onGround){
    vy=16; onGround=false;
  }

  vy-=1; y+=vy;
  if(y<=60){ y=60; vy=0; onGround=true; }

  player.style.left=x+"px";
  player.style.bottom=y+"px";

  moveNPCs();
  checkNPC();
  checkDoor();

  requestAnimationFrame(update);
}

function moveNPCs(){
  npcs.forEach(npc=>{
    npc.x+=npc.speed*npc.dir;
    if(npc.x>=npc.end||npc.x<=npc.start) npc.dir*=-1;
    npc.el.style.left=npc.x+"px";
  });
}

function checkNPC(){
  if(hitCooldown) return;
  const p=player.getBoundingClientRect();
  npcs.forEach(npc=>{
    const n=npc.el.getBoundingClientRect();
    if(p.right>n.left&&p.left<n.right&&p.bottom>n.top&&p.top<n.bottom){
      handleHit();
    }
  });
}

function handleHit(){
  hitCooldown=true;
  lives--; livesEl.innerText=lives;
  game.classList.add("shake");
  player.classList.add("hit");

  setTimeout(()=>{
    game.classList.remove("shake");
    player.classList.remove("hit");
    hitCooldown=false;
  },300);

  x=40; y=60; vy=0; onGround=true;

  if(lives<=0){
    alert("ðŸ˜µ Sin vidas. Reiniciamos.");
    resetGame();
  }
}

function checkDoor(){
  if(questionOpen) return;
  const p=player.getBoundingClientRect();
  const d=door.getBoundingClientRect();
  if(p.right>d.left&&p.left<d.right&&p.bottom>d.top&&p.top<d.bottom){
    questionOpen=true;
    openQuestion();
  }
}

function openQuestion(){
  question.style.display="flex";
  feedback.innerText="";
  qText.innerText=phases[phase].q;
  options.innerHTML="";
  phases[phase].a.sort(()=>Math.random()-0.5);
  phases[phase].a.forEach(opt=>{
    const b=document.createElement("button");
    b.innerText=opt.t;
    b.onclick=()=>answer(opt.c);
    options.appendChild(b);
  });
}

function answer(correct){
  if(correct){
    feedback.innerText="âœ… Â¡Correcto!";
    setTimeout(nextPhase,700);
  } else {
    feedback.innerText="âŒ IntentÃ¡ de nuevo.";
  }
}

function nextPhase(){
  question.style.display="none";
  phase++;
  questionOpen=false;
  if(phase>=phases.length){
    alert("ðŸŽ‰ Â¡Completaste el juego!");
    resetGame();
  }
  phaseNumEl.innerText=phase+1;
  x=40;
}

function resetGame(){
  phase=0;
  lives=3;
  phaseNumEl.innerText=1;
  livesEl.innerText=3;
  x=40; y=60; vy=0;
  questionOpen=false;
}

update();
</script>

</body>
</html>
